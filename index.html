<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Rabia ‚ù§Ô∏è</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <!-- GSAP for Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        :root {
            --primary: #ff4d6d;
            --secondary: #ff758f;
            --accent: #c9184a;
            --bg: #fff0f3;
            --text: #590d22;
            --white: #ffffff;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg);
            background-image: linear-gradient(120deg, #fccb90 0%, #d57eeb 100%);
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
            transition: background-image 1s ease;
        }

        /* Floating background hearts */
        .bg-heart {
            position: absolute;
            color: rgba(255, 255, 255, 0.4);
            z-index: 0;
            user-select: none;
            pointer-events: none;
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            width: 90%;
            max-width: 450px;
            min-height: 500px;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            text-align: center;
            position: relative;
            z-index: 10;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transform-style: preserve-3d;
            overflow: hidden; /* Kept for other screens, but No button will escape this */
        }

        /* Progress Bar for the 'Story' mode */
        .progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 6px;
            background: var(--primary);
            width: 0%;
            border-radius: 20px 20px 0 0;
            transition: width 0.3s ease;
            z-index: 20;
        }

        h1 {
            font-family: 'Dancing Script', cursive;
            color: var(--accent);
            font-size: 2.8rem;
            margin-bottom: 1rem;
            line-height: 1.1;
        }

        p {
            color: var(--text);
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        /* Images & GIFs */
        .gif-container {
            width: 200px;
            height: 200px;
            margin: 0 auto 1.5rem;
            border-radius: 50%;
            overflow: hidden;
            border: 4px solid var(--secondary);
            background: white;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .gif-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Navigation Buttons */
        .btn {
            font-family: 'Nunito', sans-serif;
            font-weight: 700;
            border: none;
            padding: 12px 32px;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 5px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--accent);
            transform: scale(1.05);
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--secondary);
        }

        /* Proposal Specifics */
        .proposal-btns {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 1rem;
            position: relative; /* Context for absolute positioning of 'No' button */
            width: 100%;
            height: 60px; /* Reserve space */
        }

        /* The hidden sections */
        .screen {
            display: none;
            width: 100%;
            height: 100%;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .screen.active {
            display: flex;
        }

        /* Polaroid Photo Style for Success */
        .polaroid {
            background: white;
            padding: 10px 10px 30px 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transform: rotate(-3deg);
            margin-bottom: 1rem;
            width: 80%;
            transition: transform 0.3s ease;
        }
        .polaroid:hover {
            transform: rotate(0deg) scale(1.02);
        }
        .polaroid img {
            width: 100%;
            display: block;
        }

        /* Floating emoji animation class */
        .floater {
            position: fixed;
            pointer-events: none;
            z-index: 100;
        }

    </style>
</head>
<body>

    <!-- Background Hearts (Generated by JS) -->
    <div id="bg-hearts"></div>

    <div class="card">
        <div class="progress-bar" id="progress"></div>

        <!-- SCREEN 1: Intro -->
        <div class="screen active" id="screen-intro">
            <div class="gif-container">
                <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbXN5eWk4aWk3MXo4b2sxNHJ2YXA5Z2w5b3p4Z2w5b3p4Z2w5b3p4dyZlcD12MV9zdGlja2Vyc19zZWFyY2gmY3Q9cw/iCVzZwwE6QhZPq7jNx/giphy.gif" alt="Cute waving bear">
            </div>
            <h1 id="intro-title">Hey Rabia! ‚ù§Ô∏è</h1>
            <p>I have a very important question to ask you...</p>
            <p>But first, let me tell you why you're so special.</p>
            <button class="btn btn-primary" onclick="nextScreen('screen-reason1')">Tell me! ü§≠</button>
        </div>

        <!-- SCREEN 2: Reason 1 -->
        <div class="screen" id="screen-reason1">
            <div class="gif-container">
                <img src="https://media.giphy.com/media/26BRv0ThflsHCqDrG/giphy.gif" alt="Laughing">
            </div>
            <h1>1. Your Laugh</h1>
            <p>It's my favorite sound in the whole world. When you're happy, I'm happy.</p>
            <button class="btn btn-primary" onclick="nextScreen('screen-reason2')">Aww, next! üëâ</button>
        </div>

        <!-- SCREEN 3: Reason 2 -->
        <div class="screen" id="screen-reason2">
            <div class="gif-container">
                <img src="https://media.giphy.com/media/l4pTfx2qLszoacZRS/giphy.gif" alt="Hugging">
            </div>
            <h1>2. Your Hugs</h1>
            <p>You feel like home. Rabia, I never want to let go when I'm with you.</p>
            <button class="btn btn-primary" onclick="nextScreen('screen-proposal')">Okay, ask me! ü´£</button>
        </div>

        <!-- SCREEN 4: The Proposal -->
        <div class="screen" id="screen-proposal">
            <div class="gif-container" id="proposal-gif">
                <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNnd4eWs1cW15cW15cW15cW15cW15cW15cW15cW15cW15cW15cW0mZXA9djFfc3RpY2tlcnNfc2VhcmNoJmN0PXM/3o7TKoWXm3okO1kgHC/giphy.gif" alt="Heart beating">
            </div>
            <h1 id="main-question">Will you be my Valentine?</h1>
            <p id="sub-text">Please say yes! ü•∫</p>
            
            <div class="proposal-btns">
                <button class="btn btn-primary" id="yes-btn" onclick="acceptProposal()">Yes! üíñ</button>
                <button class="btn btn-secondary" id="no-btn">No</button>
            </div>
        </div>

        <!-- SCREEN 5: Success -->
        <div class="screen" id="screen-success">
            <div class="polaroid">
                <!-- Use a romantic placeholder image -->
                <img src="https://images.unsplash.com/photo-1518199266791-5375a83190b7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Us">
                <div style="font-family: 'Dancing Script'; font-size: 1.5rem; text-align: center; margin-top: 10px; color: #333;">Us Forever ‚ù§Ô∏è</div>
            </div>
            <h1 id="success-title">YAY! üéâ</h1>
            <p id="success-message">Best. Valentine. Ever.</p>
            <p style="font-size: 0.9rem; color: #666;">(Check your calendar for Feb 14th!)</p>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const partnerName = "Rabia"; 
        // --------------------------------------------------

        // --- Init GSAP & Background ---
        gsap.to(".card", {duration: 1, y: 0, opacity: 1, ease: "back.out(1.7)"});

        // Initialize Name on Load
        function initName() {
            document.getElementById('intro-title').innerText = `Hey ${partnerName}! ‚ù§Ô∏è`;
            const nameSpans = document.querySelectorAll('.partner-name');
            nameSpans.forEach(span => span.innerText = partnerName);
        }
        initName();

        // Generate floating background hearts
        const bgContainer = document.getElementById('bg-hearts');
        const emojis = ['‚ù§Ô∏è', 'üíñ', 'üíï', 'üå∑', 'ü•∞', '‚ú®'];

        function createHeart() {
            const el = document.createElement('div');
            el.classList.add('bg-heart');
            el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
            el.style.left = Math.random() * 100 + 'vw';
            el.style.top = Math.random() * 100 + 'vh';
            el.style.fontSize = (Math.random() * 20 + 20) + 'px';
            bgContainer.appendChild(el);
            
            gsap.to(el, {
                y: -100,
                x: "random(-50, 50)",
                rotation: "random(-90, 90)",
                duration: "random(10, 20)",
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut"
            });
        }
        // Create initial batch
        for(let i=0; i<25; i++) createHeart();

        // --- Global State ---
        let noClicks = 0;
        const totalScreens = 5; // Intro, R1, R2, Prop, Succ
        let currentStep = 1;

        // --- Navigation Logic ---
        function nextScreen(targetId) {
            const current = document.querySelector('.screen.active');
            const next = document.getElementById(targetId);
            
            // Update progress bar
            currentStep++;
            const progress = ((currentStep - 1) / (totalScreens - 1)) * 100;
            gsap.to('#progress', {width: progress + '%', duration: 0.5});

            // Transition Animation
            const tl = gsap.timeline();
            tl.to(current, {
                opacity: 0, 
                x: -50, 
                duration: 0.3, 
                onComplete: () => {
                    current.classList.remove('active');
                    next.classList.add('active');
                }
            })
            .fromTo(next, 
                {opacity: 0, x: 50}, 
                {opacity: 1, x: 0, duration: 0.5, ease: "power2.out"}
            );
        }

        // --- The "No" Button Logic (The Emotional Rollercoaster) ---
        const noBtn = document.getElementById('no-btn');
        const proposalGif = document.querySelector('#proposal-gif img');
        const mainQuestion = document.getElementById('main-question');
        const subText = document.getElementById('sub-text');

        // Rollercoaster Stages
        const stages = [
            {
                text: "Wait, really? üò¢",
                sub: "You clicked the wrong button, right?",
                gif: "https://media.giphy.com/media/OPU6wzx8JrHna/giphy.gif" // Sad cat
            },
            {
                text: "Are you serious?! üò≠",
                sub: "My heart is breaking!",
                gif: "https://media.giphy.com/media/26ufcVAp3AiJJsrIs/giphy.gif" // Crying
            },
            {
                text: "Don't do this! üíî",
                sub: "I'll make you cookies every day!",
                gif: "https://media.giphy.com/media/l2JhrhAtnJSDNJ2jz/giphy.gif" // Begging
            },
            {
                text: "QUIT PLAYING! üî´üò†",
                sub: "I'm not asking anymore!",
                gif: "https://media.giphy.com/media/11tTNkNy1SdXGg/giphy.gif" // Angry/Gun
            }
        ];

        function moveNoBtn() {
            // CRITICAL FIX: The card has 3D transform which traps fixed position elements.
            // We must move the button to the body to let it fly freely on the whole screen.
            if (noBtn.parentNode !== document.body) {
                const rect = noBtn.getBoundingClientRect();
                noBtn.style.position = 'fixed';
                noBtn.style.left = rect.left + 'px';
                noBtn.style.top = rect.top + 'px';
                noBtn.style.width = rect.width + 'px'; // Prevent it from shrinking
                noBtn.style.zIndex = '1000'; 
                document.body.appendChild(noBtn);
            }

            // Get viewport dimensions
            const padding = 20;
            const maxX = window.innerWidth - noBtn.offsetWidth - padding;
            const maxY = window.innerHeight - noBtn.offsetHeight - padding;
            
            const randomX = Math.max(padding, Math.random() * maxX);
            const randomY = Math.max(padding, Math.random() * maxY);

            gsap.to(noBtn, {
                left: randomX,
                top: randomY,
                duration: 0.5, // Slower duration so it's visible moving
                ease: "power2.out",
                rotation: Math.random() * 30 - 15
            });
        }

        function handleNoInteraction(e) {
            e.preventDefault(); 
            noClicks++;
            moveNoBtn();

            // Background gets redder/intense as you deny
            if(noClicks < 5) {
                document.body.style.backgroundImage = `linear-gradient(120deg, #fccb90 0%, #ff${99 - (noClicks*20)}99 100%)`;
            }

            // Update content based on persistence
            const stageIndex = Math.min(noClicks - 1, stages.length - 1);
            const stage = stages[stageIndex];

            // Animate text change
            gsap.to([mainQuestion, subText], {
                scale: 0.9,
                duration: 0.1,
                yoyo: true,
                repeat: 1,
                onStart: () => {
                    mainQuestion.innerHTML = stage.text;
                    subText.innerHTML = stage.sub;
                    proposalGif.src = stage.gif;
                }
            });

            // Card Shake
            gsap.fromTo(".card", 
                {x: -10}, 
                {x: 10, duration: 0.05, repeat: 5, yoyo: true}
            );
        }

        noBtn.addEventListener('mouseenter', handleNoInteraction);
        noBtn.addEventListener('touchstart', handleNoInteraction);

        // --- The "Yes" Logic (Dynamic Banter) ---
        function acceptProposal() {
            // Clean up the rogue button if it's on the body
            if (noBtn.parentNode === document.body) {
                noBtn.remove();
            }

            const title = document.getElementById('success-title');
            const msg = document.getElementById('success-message');
            const finalImg = document.querySelector('.polaroid img');
            
            // Logic for the response message
            if (noClicks === 0) {
                // CASE 1: 0 Tries (Immediate Yes)
                title.innerText = "YAY! First Try! üéâ";
                msg.innerHTML = `Wow, ${partnerName}, you didn't even hesitate! I knew you loved me! üòé<br>I knew you'd say yes!`;
                finalImg.src = "https://media.giphy.com/media/TdfyKrN7HGTIY/giphy.gif"; // Success dance
            } else if (noClicks <= 2) {
                // CASE 2: 1-2 Tries (Playful)
                title.innerText = "Finally! üòè";
                msg.innerHTML = `Playing hard to get, huh ${partnerName}? I love the chase!<br>But I knew you'd say yes eventually! ‚ù§Ô∏è`;
                finalImg.src = "https://media.giphy.com/media/meJO2dyWfQ07K/giphy.gif"; // Wink
            } else {
                // CASE 3: 3+ Tries (Hard Battle)
                title.innerText = "PHEW! üòÖ";
                msg.innerHTML = `You almost gave me a heart attack, ${partnerName}!<br>But I knew you couldn't resist me forever! ü•∞`;
                finalImg.src = "https://media.giphy.com/media/MDJ9IbxxvDUQM/giphy.gif"; // Happy cat
            }

            nextScreen('screen-success');
            fireConfetti();
        }

        function fireConfetti() {
            // Explosive Confetti
            const count = 200;
            const defaults = {
                origin: { y: 0.7 }
            };

            for(let i=0; i<count; i++) {
                const conf = document.createElement('div');
                conf.innerText = ['‚ù§Ô∏è', 'üéâ', 'üåπ', 'üòª', 'üíç', '‚ú®'][Math.floor(Math.random()*6)];
                conf.classList.add('floater');
                conf.style.left = '50%';
                conf.style.top = '50%';
                conf.style.fontSize = Math.random() * 25 + 10 + 'px';
                document.body.appendChild(conf);

                const angle = Math.random() * Math.PI * 2;
                const velocity = Math.random() * 600 + 200; // Faster explosion

                gsap.to(conf, {
                    x: Math.cos(angle) * velocity,
                    y: Math.sin(angle) * velocity,
                    rotation: Math.random() * 360,
                    opacity: 0,
                    scale: Math.random() * 0.5 + 0.5,
                    duration: Math.random() * 2 + 1.5,
                    ease: "power2.out",
                    onComplete: () => conf.remove()
                });
            }
        }

    </script>
</body>
</html>
